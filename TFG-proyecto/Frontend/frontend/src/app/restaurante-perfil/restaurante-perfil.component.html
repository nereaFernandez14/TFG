<div *ngIf="restaurante" class="perfil-restaurante">
  <!-- ğŸª Nombre -->
  <h2 class="nombre-restaurante"><i class="fas fa-store"></i> {{ restaurante.nombre }}</h2>

  <!-- ğŸ“ DescripciÃ³n -->
  <p class="descripcion-restaurante">
    <i class="fas fa-info-circle"></i>
    {{ restaurante.descripcion || 'Sin descripciÃ³n disponible' }}
  </p>

  <!-- â˜ï¸ Contacto -->
  <div class="info-contacto">
    <p><i class="fas fa-map-marker-alt"></i> {{ restaurante.direccion }}</p>
    <p><i class="fas fa-phone-alt"></i> {{ restaurante.telefono }}</p>
  </div>

  <!-- ğŸ·ï¸ Etiquetas -->
  <div class="etiquetas">
    <span class="etiqueta"><i class="fas fa-utensils"></i> {{ restaurante.tipoCocina }}</span>
    <span class="etiqueta"><i class="fas fa-city"></i> {{ restaurante.barrio }}</span>
    <span class="etiqueta"><i class="fas fa-euro-sign"></i> {{ restaurante.rangoPrecio }}</span>
    <span *ngFor="let restriccion of restaurante.restriccionesDieteticas" class="etiqueta">
      <i class="fas fa-leaf"></i> {{ restriccion }}
    </span>
  </div>

  <!-- ğŸï¸ Carrusel -->
  <div *ngIf="restaurante.imagenes?.length" class="carrusel">
    <button class="nav-btn" (click)="anteriorImagen()" title="Anterior">
      <i class="fas fa-chevron-left"></i>
    </button>

    <div class="carrusel-imagen">
      <img
        *ngIf="restaurante.imagenes?.length"
        [src]="'https://localhost:8443/uploads/restaurantes/' + restaurante.id + '/' + restaurante.imagenes[imagenActual]"
        alt="Imagen del restaurante"
        class="img-carrusel fade-in"
      />
    </div>

    <button class="nav-btn" (click)="siguienteImagen()" title="Siguiente">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>

  <!-- ğŸ“‹ MenÃº -->
  <div *ngIf="restaurante.rutaMenu" class="menu-restaurante">
    <h3><i class="fas fa-clipboard-list"></i> MenÃº del restaurante</h3>
    <a
      [href]="'https://localhost:8443/restaurantes/menus/' + obtenerNombreArchivo(restaurante.rutaMenu)"
      target="_blank"
      class="boton-descargar"
      download
    >
      <i class="fas fa-file-download"></i> Descargar menÃº
    </a>
  </div>

  <!-- âœï¸ AÃ±adir/Modificar reseÃ±a -->
  <ng-container *ngIf="mostrarFormularioResena; else mensajeLogin">
    <button class="btn-resena" (click)="abrirModalResena()">
      <i class="fas fa-pen"></i>
      {{ yaTieneResena ? 'Modificar reseÃ±a' : 'AÃ±adir reseÃ±a' }}
    </button>
  </ng-container>

  <!-- ğŸ”’ Requiere login -->
  <ng-template #mensajeLogin>
    <p class="aviso-login">
      <i class="fas fa-lock"></i> Debes iniciar sesiÃ³n para dejar una reseÃ±a.
    </p>
  </ng-template>

  <!-- ğŸ’¬ Modal de ReseÃ±a -->
  <div class="modal-backdrop" *ngIf="modalAbierto" (click)="cerrarModal()">
    <div class="modal" (click)="$event.stopPropagation()">
      <app-resenya
        [restauranteNombre]="restaurante.nombre"
        [restauranteId]="restaurante.id"
        [resenaExistente]="resenaDelUsuario"
        (resenaEnviada)="recargarResenas(); cerrarModal()"
      ></app-resenya>

      <button class="cerrar-modal" (click)="cerrarModal()"><i class="fas fa-times"></i></button>
    </div>
  </div>

  <!-- ğŸŒŸ ReseÃ±as -->
  <div class="resenas">
    <h3><i class="fas fa-comments"></i> ReseÃ±as</h3>

    <div *ngIf="resenas.length === 0" class="sin-reseÃ±as">
      <i class="fas fa-comment-slash"></i> No hay reseÃ±as aÃºn.
    </div>

    <div *ngFor="let resena of resenas" class="resena-card">
      <!-- â­ ValoraciÃ³n -->
      <div class="estrellas">
        <ng-container *ngFor="let i of [1,2,3,4,5]">
          <span [class.activa]="i <= resena.valoracion"><i class="fas fa-star"></i></span>
        </ng-container>
      </div>

      <!-- ğŸ“ Comentario -->
      <p *ngIf="resena.contenido"><em><i class="fas fa-quote-left"></i> {{ resena.contenido }}</em></p>

      <!-- ğŸ–¼ï¸ ImÃ¡genes -->
      <div *ngIf="resena.imagenes?.length > 0" class="imagenes-resena">
        <div class="img-wrapper" *ngFor="let img of resena.imagenes">
          <img
            [src]="'/api/imagenes/' + img.id"
            [alt]="img.nombreArchivo"
            class="img-resena"
          />
        </div>
      </div>

      <!-- ğŸ—‘ï¸ Acciones -->
      <div class="acciones-resena" *ngIf="esAutorDeResena(resena.autorEmail)">
        <button class="btn btn-danger" (click)="borrarResena(resena.id)">
          <i class="fas fa-trash-alt"></i> Eliminar reseÃ±a
        </button>
      </div>
    </div>
  </div>
</div>
